/************************************************** Description *******************************************************/
/*
    File : Servo.h
    Programmer : Milad Mahmodian
    Used : Servo Driver
    Design Pattern : Nothing
    Types of memory : Nothing
    Total Tread : Nothing
    Site : Nothing
    Tel : +989044743354
    Email : milad_mahmodian@outlook.ir
    Last Update : 2024/8/24
*/
/************************************************** Warnings **********************************************************/
/*
    Nothing
*/
/************************************************** Wizards ***********************************************************/
/*
    Nothing
*/
/************************************************** Includes **********************************************************/
#include "servo.h"

/************************************************** Defineds **********************************************************/
#define SERVO_TIMER_INTERFACE                                  2
/************************************************** Names *************************************************************/
/*
    Nothing
*/
/************************************************** Variables *********************************************************/
/*
    Nothing
*/
/************************************************** Opjects ***********************************************************/
/*
    Nothing
*/
/************************************************** Functions *********************************************************/
void __init_SERVO() {
	PWM_Common_Config(SERVO_TIMER_INTERFACE, 249, 19999, TIM_CLOCKDIVISION_DIV1);
	for (U8 Channel = 1;Channel < 5; Channel++){
		PWM_Channel_Config(SERVO_TIMER_INTERFACE, Channel);
	}
}
/*--------------------------------------------------------------------------------------------------------------------*/
U8 Servo_Ready() {
	return PWM_Ready(SERVO_TIMER_INTERFACE);
}
/*--------------------------------------------------------------------------------------------------------------------*/
void SERVO_Set_Pos(U32 Channel, U16 Angle) {
	if(Angle > 225 || Angle < 0) {
		Error_Handler();
	}
	while (!Servo_Ready()) {
		osDelay(1);
	}
	PWM_Set_DutyCycle(SERVO_TIMER_INTERFACE, Channel, (Angle * 2000 / 180) + 500);
}
/************************************************** Tasks *************************************************************/
/*
    Nothing
*/
/************************************************** Vectors ***********************************************************/
/*
    Nothing
*/
/**********************************************************************************************************************/
